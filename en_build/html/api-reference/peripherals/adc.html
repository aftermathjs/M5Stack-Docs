

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Analog to Digital Converter &mdash; M5Stack 1.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Digital To Analog Converter" href="dac.html" />
    <link rel="prev" title="Peripherals API" href="index.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> M5Stack
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../product-documents/index.html">Product Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../mesh/index.html">Mesh</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Peripherals</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">ADC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-and-reading-adc">Configuration and Reading ADC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dac.html">DAC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../m5stack-faq/index.html">M5Stack-FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../m5stack-awesome/index.html">M5Stack-awesome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">[语言/Languages]</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">M5Stack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
          <li><a href="index.html">Peripherals API</a> &raquo;</li>
        
      <li>Analog to Digital Converter</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api-reference/peripherals/adc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="analog-to-digital-converter">
<h1>Analog to Digital Converter<a class="headerlink" href="#analog-to-digital-converter" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>ESP32  integrates two 12-bit SAR (<a class="reference external" href="https://en.wikipedia.org/wiki/Successive_approximation_ADC">Successive Approximation Register</a>) ADCs (Analog to Digital Converters) and supports measurements on 18 channels (analog enabled pins). Some of these pins can be used to build a programmable gain amplifier which is used for the measurement of small analog signals.</p>
<p>The ADC driver API supports ADC1 (8 channels, attached to GPIOs 32 - 39), and ADC2 (10 channels, attached to GPIOs 0, 2, 4, 12 - 15 and 25 - 27).
However, there’re some restrictions for the application to use ADC2:</p>
<ol class="arabic simple">
<li>The application can use ADC2 only when Wi-Fi driver is not started, since the ADC is also used by the Wi-Fi driver, which has higher priority.</li>
<li>Some of the ADC2 pins are used as strapping pins (GPIO 0, 2, 15), so they cannot be used freely. For examples, for official Develop Kits:</li>
</ol>
</div>
<div class="section" id="configuration-and-reading-adc">
<h2>Configuration and Reading ADC<a class="headerlink" href="#configuration-and-reading-adc" title="Permalink to this headline">¶</a></h2>
<p>The ADC should be configured before reading is taken.</p>
<blockquote>
<div><ul class="simple">
<li>For ADC1, configure desired precision and a  ttenuation by calling functions <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc1_config_width()</span></code> and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc1_config_channel_atten()</span></code>.</li>
<li>For ADC2, configure the attenuation by <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc2_config_channel_atten()</span></code>. The reading width of ADC2 is configured every time you take the reading.</li>
</ul>
</div></blockquote>
<p>Attenuation configuration is done per channel, see <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">adc1_channel_t</span></code> and <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">adc2_channel_t</span></code>, set as a parameter of above functions.</p>
<p>Then it is possible to read ADC conversion result with <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc1_get_raw()</span></code> and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc2_get_raw()</span></code>. Reading width of ADC2 should be set as a parameter of <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc2_get_raw()</span></code> instead of in the configuration functions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the ADC2 is shared with the WIFI module, which has higher priority, reading operation of <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc2_get_raw()</span></code> will fail between <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_wifi_start()</span></code> and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_wifi_stop()</span></code>. Use the return code to see whether the reading is successful.</p>
</div>
<p>It is also possible to read the internal hall effect sensor via ADC1 by calling dedicated function <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">hall_sensor_read()</span></code>. Note that even the hall sensor is internal to ESP32, reading from it uses channels 0 and 3 of ADC1 (GPIO 36 and 39). Do not connect anything else to these pins and do not change their configuration. Otherwise it may affect the measurement of low value signal from the sesnor.</p>
<p>There is another specific function <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">adc2_vref_to_gpio()</span></code> used to route internal reference voltage to a GPIO pin. It comes handy to calibrate ADC reading and this is discussed in section <span class="xref std std-ref">adc-api-adc-calibration</span>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dac.html" class="btn btn-neutral float-right" title="Digital To Analog Converter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Peripherals API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 - 2018, M5Stack Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.1',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>